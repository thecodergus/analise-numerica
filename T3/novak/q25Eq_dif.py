import math

def rk4(f, x0, y0,x_values, n):
    r = []
    h = x_values[0] - x0
    for _ in range(n):
        #realizar as iterações
        if (_>=1):
            h = x_values[_] - x_values[_-1]
        m1 = f(x0, y0)
        m2 = f(x0 + h/2, y0 + (h/2)*m1)
        m3 = f(x0 + h/2, y0 + (h/2)*m2)
        m4 = f(x0 + h, y0 + h *m3)
        yk = y0 + h * (m1+2*m2+2*m3+m4)/6
        #atualizando os valores
        x0 = x_values[_]
        y0 = yk
        #colocando valores na lista
        r.append((x0, y0))
    return r
    
# modificar valores de r e lambd    
def f(p, t):
    r = 0.11337
    lambd = 0.01346
    k = r * lambd
    return k * (1 - t)

# modificar valor de p0    
t0 = 0
p0 = 0.00193
t_values = [0.44724, 0.90796, 1.42924, 2.55682, 2.84894, 3.8521, 4.19143, 5.24583, 5.57689, 6.34045, 7.03561, 7.53526, 8.24606, 8.82613, 9.71159, 10.21358, 10.90825, 11.83017, 12.48687, 13.13602, 13.43128, 14.56206, 14.80572, 15.63736, 16.33573, 17.12814, 17.90652, 18.32859, 18.96465, 19.42947, 20.24737, 21.13615, 21.68157, 22.59246, 22.81907, 23.67708, 24.39032, 24.73891, 25.6778, 26.07172, 26.94412, 27.41035, 28.26716, 29.15869, 29.60882, 30.39772, 31.224, 31.88002, 32.18154, 33.05071, 33.58428, 34.54996, 35.20869, 35.42243, 36.45701, 37.01593, 37.69304, 38.362, 39.06551, 39.73962, 40.53898, 41.20614, 41.67748, 42.28083, 42.89577, 43.53239, 44.16508, 45.05395, 45.90854, 46.57351, 46.84021, 47.62828, 48.21125, 49.05968, 49.79247, 50.16079, 50.84097, 51.61486, 52.32354, 52.7805, 53.64066, 54.26735, 55.21981, 55.74029, 56.39063, 56.85938, 57.48673, 58.29962, 59.08062, 59.40815, 60.53006, 60.75619, 61.78082, 62.22142, 62.95901, 63.90385, 64.53505, 64.79171, 65.74598, 66.20313, 66.87556, 67.57794, 68.58902, 68.80814, 69.46542, 70.49574, 70.92016, 71.57215, 72.4427, 72.86964, 73.71417, 74.14124, 74.76187, 75.51327, 76.39946, 77.14514, 77.81589, 78.2261, 79.03574, 79.59114, 80.37757, 81.10224, 81.88334, 82.33848, 83.25337, 83.88484, 84.12049, 85.22189, 85.71244, 86.17574, 86.81413, 87.7053, 88.26876, 89.19232, 89.52255, 90.27777, 91.25078, 91.50237, 92.45954, 93.06912, 93.52141, 94.483, 95.05653, 95.7731, 96.56151, 96.80472, 97.83344, 98.38266, 98.75532, 99.54153]
n = 150

r = rk4(f, t0, p0, t_values, n)

runge = []
for yi in r:
    runge.append(yi[1])
    
# solução exata:
# modificar valores de r, lambd e coef 
def p(t):
    r = 0.11337
    lambd = 0.01346
    k = r * lambd
    # resolver:
    # solve p'(t) = k * (1 - p(t)), p(0) = p0
    # no wolfram, substituindo o valor de p0 dado na questao
    coef = 0.9986
    return 1 - coef * math.exp(-k*t)
    
for i in range(150):
    print(f"{runge[i]}, {0},")